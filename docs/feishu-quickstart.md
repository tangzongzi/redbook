# 飞书集成快速开始

## 一句话概括

**在飞书表格中审核内容，系统自动发布到小红书。**

## 工作流程

```
系统生成内容 ──▶ 写入飞书表格 ──▶ 你修改状态为「已通过」 ──▶ 自动发布
```

## 三步配置

### 第 1 步：创建飞书应用

1. 打开 https://open.feishu.cn/app
2. 点击「创建企业自建应用」
3. 记录 **App ID** 和 **App Secret**

### 第 2 步：创建多维表格

1. 在飞书中新建多维表格
2. 添加以下字段：

| 字段 | 类型 |
|------|------|
| 标题 | 文本 |
| 正文 | 多行文本 |
| 标签 | 文本 |
| 状态 | 单选（待审核/已通过/已发布）|
| 创建时间 | 日期时间 |
| 发布时间 | 日期时间 |
| 笔记ID | 文本 |

3. 从 URL 中获取 `app_token` 和 `table_id`

### 第 3 步：配置环境变量

编辑 `.env` 文件：

```bash
FEISHU_APP_ID=cli_xxxxxxxxxx
FEISHU_APP_SECRET=xxxxxxxxxx
FEISHU_BITABLE_APP_TOKEN=xxxxxxxxxx
FEISHU_BITABLE_TABLE_ID=xxxxxxxxxx
```

启用飞书集成：

```yaml
# config/config.yaml
feishu:
  enabled: true
```

重启服务即可生效。

## 使用方法

### 生成内容

内容会自动写入飞书表格，状态为「待审核」。

### 审核内容

1. 打开飞书表格
2. 找到「待审核」的内容
3. 将「状态」修改为「已通过」
4. 系统每 5 分钟自动检查，发布到小红书

### 发布完成

- 飞书表格状态自动变为「已发布」
- 自动填充「笔记ID」和「分享链接」

## 手动同步

如果想立即发布已通过的内容：

```bash
curl -X POST http://localhost:9999/api/feishu/sync
```

或在 Web UI 中点击同步按钮（如果有）。

## 常见问题

**Q: 飞书写入失败怎么办？**

检查：
1. 应用是否已发布
2. 权限是否已申请（bitable:record, bitable:app）
3. 字段名称是否完全匹配

**Q: 可以不使用飞书吗？**

可以。不配置飞书环境变量时，系统只使用本地 Web UI 进行审核。

**Q: 飞书和 Web UI 可以同时使用吗？**

可以。内容会同时写入两处，你可以在任意一处进行审核。

## 详细配置

更详细的配置请参考 [飞书配置指南](feishu-setup.md)
